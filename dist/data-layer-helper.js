!function(a,b){function c(a,b){for(var c={},d=c,e=a.split("."),f=0;f<e.length-1;f++)d=d[e[f]]={};return d[e[e.length-1]]=b,c}function d(a){return"array"==f(a)}function e(a,b){for(var c in a)if(g(a,c)){var f=a[c];d(f)?(d(b[c])||(b[c]=[]),e(f,b[c])):h(f)?(h(b[c])||(b[c]={}),e(f,b[c])):b[c]=f}}function f(a){if(null===a||void 0===a)return String(a);var b=TYPE_RE_.exec(Object.prototype.toString.call(Object(a)));return b?b[1].toLowerCase():"object"}function g(a,b){return Object.prototype.hasOwnProperty.call(Object(a),b)}function h(a){if(!a||"object"!=f(a)||a.nodeType||a==a.window)return!1;try{if(a.constructor&&!g(a,"constructor")&&!g(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}var c;for(c in a);return void 0===c||g(a,c)}b.DataLayerHelper=a;var i=function(a,b,c){this.dataLayer_=a,this.listener_=b||function(){},this.executingListener_=!1,this.model_={},this.unprocessed_=[],this.processStates_(a,!c);var d=this,e=a.push;a.push=function(){var b=[].slice.call(arguments,0),c=e.apply(a,b);return d.processStates_(b),c}};i.prototype.get=function(a){for(var b=this.model_,c=a.split("."),d=0;d<c.length;d++){if(void 0===b[c[d]])return void 0;b=b[c[d]]}return b},i.prototype.flatten=function(){this.dataLayer_.splice(0,this.dataLayer_.length),this.dataLayer_[0]={},e(this.model_,this.dataLayer_[0])},i.prototype.processStates_=function(a,b){for(this.unprocessed_.push.apply(this.unprocessed_,a);this.executingListener_===!1&&this.unprocessed_.length>0;){var d=this.unprocessed_.shift();if(h(d)){for(var f in d)e(c(f,d[f]),this.model_);b||(this.executingListener_=!0,this.listener_(this.model_,d),this.executingListener_=!1)}}},TYPE_RE_=/\[object (Boolean|Number|String|Function|Array|Date|RegExp)\]/}({},function(){return this}());